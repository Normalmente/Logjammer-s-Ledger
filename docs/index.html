<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Logjammer's Ledger</title>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    :root {
      --sand: #e7d7b7;
      --dune-blue: #3c4a57;
      --russian-cream: #f4efe4;
      --kahlua: #5e3c26;
      --vodka: #cbd2d0;
      --black: #1a1a1a;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: var(--sand);
      color: var(--black);
    }

    header {
      background: var(--dune-blue);
      color: var(--russian-cream);
      padding: 1rem;
      text-align: center;
    }

    .container {
      max-width: 700px;
      margin: 0 auto;
      padding: 1rem;
    }

    .post {
      background: var(--russian-cream);
      border: 1px solid var(--vodka);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .attached-image {
      max-width: 100%;
      border-radius: 6px;
      margin-top: 0.5rem;
    }

    .meta {
      font-size: 0.85rem;
      color: var(--kahlua);
      margin-top: 0.5rem;
    }

    .admin-tools {
      margin-top: 2rem;
    }

    .admin-tools textarea,
    .admin-tools input,
    .admin-tools select {
      width: 100%;
      margin-bottom: 0.5rem;
      padding: 0.5rem;
      border-radius: 5px;
      border: 1px solid var(--vodka);
    }

    .admin-tools button {
      background: var(--dune-blue);
      color: var(--russian-cream);
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .share-links a {
      margin-right: 1rem;
      text-decoration: none;
      color: var(--dune-blue);
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <h1>Logjammer's Ledger</h1>
    <p id="modeInfo">View-Only Mode</p>
  </header>
  <div class="container">
    <div id="entries"></div>

    <div class="admin-tools" id="adminSection" style="display:none;">
      <h2>New Entry</h2>
      <textarea id="entryText" rows="5" placeholder="What's on your mind?"></textarea>
      <input type="text" id="entryTags" placeholder="Tags (comma separated)">
      <select id="entryMood">
        <option value="">Select Mood</option>
        <option value="😊 Happy">😊 Happy</option>
        <option value="😞 Sad">😞 Sad</option>
        <option value="😐 Neutral">😐 Neutral</option>
        <option value="😡 Angry">😡 Angry</option>
        <option value="🤔 Pensive">🤔 Pensive</option>
      </select>
      <input type="file" id="entryImage" accept="image/*">
      <button onclick="saveEntry()">Publish Entry</button>
    </div>
  </div>

  <script>
    const isAdmin = window.location.hash === '#admin';
    document.getElementById('modeInfo').innerText = isAdmin ? 'Admin Mode' : 'View-Only Mode';
    if (isAdmin) {
      document.getElementById('adminSection').style.display = 'block';
    }

    const entriesContainer = document.getElementById('entries');
    const storedEntries = JSON.parse(localStorage.getItem('ledgerPosts') || '[]');

    function renderEntries(entries) {
      entriesContainer.innerHTML = '';
      entries.reverse().forEach(entry => {
        const post = document.createElement('div');
        post.className = 'post';

        const content = document.createElement('div');
        content.innerHTML = marked.parse(entry.text);
        post.appendChild(content);

        if (entry.image) {
          const img = document.createElement('img');
          img.src = entry.image;
          img.className = 'attached-image';
          post.appendChild(img);
        }

        const meta = document.createElement('div');
        meta.className = 'meta';
        meta.innerHTML = `${entry.mood} ${entry.tags.length ? '| #' + entry.tags.join(', #') : ''}`;
        post.appendChild(meta);

        const share = document.createElement('div');
        share.className = 'share-links';
        const emailLink = document.createElement('a');
        emailLink.href = `mailto:frytrix1986@gmail.com?subject=Diary Entry&body=${encodeURIComponent(entry.text)}`;
        emailLink.textContent = 'Gmail';
        const waLink = document.createElement('a');
        waLink.href = `https://wa.me/?text=${encodeURIComponent(entry.text)}`;
        waLink.textContent = 'WhatsApp';
        share.appendChild(emailLink);
        share.appendChild(waLink);

        post.appendChild(share);
        entriesContainer.appendChild(post);
      });
    }

    renderEntries([...storedEntries]);

    function saveEntry() {
      const text = document.getElementById('entryText').value.trim();
      const tags = document.getElementById('entryTags').value.split(',').map(t => t.trim()).filter(Boolean);
      const mood = document.getElementById('entryMood').value;
      const imageInput = document.getElementById('entryImage');
      const file = imageInput.files[0];

      const save = (imageData = null) => {
        const newEntry = { text, tags, mood, image: imageData };
        storedEntries.push(newEntry);
        localStorage.setItem('ledgerPosts', JSON.stringify(storedEntries));
        renderEntries([...storedEntries]);
        document.getElementById('entryText').value = '';
        document.getElementById('entryTags').value = '';
        document.getElementById('entryMood').selectedIndex = 0;
        imageInput.value = '';
      };

      if (file) {
        const reader = new FileReader();
        reader.onload = e => save(e.target.result);
        reader.readAsDataURL(file);
      } else {
        save();
      }
    }
  </script>
</body>
</html>

</body>
</html>

